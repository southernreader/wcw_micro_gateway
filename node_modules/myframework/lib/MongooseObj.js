var Mongoose = require('mongoose');
var MongooseModel = require('./MongooseModel');
module.exports = MongooseObj;

function MongooseObj(config) {	
	console.log("Creating Mongoose Model "+JSON.stringify(config.uri));
	this.mongoose = Mongoose.connect(config.uri, config.options, function(err) {
	//this.mongoose = Mongoose.connect(require("envar")("mongodb_uri"), function(err) {	
	    if (err) console.log(err);
	});
}

MongooseObj.prototype.model = function (modelName,attributes,options) {
	for ( var attributename in attributes) {

		switch (attributes[attributename].type) {
			case "String":
				attributes[attributename].type = String;
				break;
			case "Integer":
				attributes[attributename].type = Number;
				break;
			case "Date":
				attributes[attributename].type = Date;
				break;
			default:
			}
		}
	return new MongooseModel(this.mongoose,modelName,attributes,options);
};




